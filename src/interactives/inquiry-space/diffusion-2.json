{
  "title": "Diffusion 2",
  "publicationStatus": "public",
  "subtitle": "",
  "about": [
  ],
  "aspectRatio": 0.95,
  "fontScale": 1,
  "models": [
    {
      "type": "md2d",
      "id": "model1",
      "url": "models/lab-version/1/md2d/inquiry-space/diffusion-2/model.json",
      "viewOptions": {
        "controlButtons": "play_reset"
      },
      "onLoad": [
        "const noConcentration = 50;",
        "const lowConcentration = [30, 20];",
        "const highConcentration = [15, 35];",
        "function addAtoms(element, charge, count, inside) {",
        "  var added = 0;",
        "  var attempts = 0;",
        "  var baseX = inside ? 2.95 : 0;",
        "  while (added < count && attempts < count * 4) {",
        "     if (addAtom({ x: baseX + 2.35 * Math.random(), y: 2.5 * Math.random(), vx: Math.random() * 0.001 - 0.0005, vy: Math.random() * 0.001 - 0.0005, element, charge })) {",
        "        added += 1;",
        "     }",
        "     attempts += 1;",
        "  }",
        "}",
        "function setupModel() {",
        "  batch(function() {",
        "    if (get('saltInside') === 'none') { addAtoms(2, 0, noConcentration, true); }",
        "    if (get('saltInside') === 'low') { addAtoms(2, 0, lowConcentration[0], true); addAtoms(0, 0.2, lowConcentration[1], true); addAtoms(4, -0.2, lowConcentration[1], true); }",
        "    if (get('saltInside') === 'high') { addAtoms(2, 0, highConcentration[0], true); addAtoms(0, 0.2, highConcentration[1], true); addAtoms(4, -0.2, highConcentration[1], true); }",
        "    if (get('saltOutside') === 'none') { addAtoms(2, 0, noConcentration, false); }",
        "    if (get('saltOutside') === 'low') { addAtoms(2, 0, lowConcentration[0], false); addAtoms(0, 0.2, lowConcentration[1], false); addAtoms(4, -0.2, lowConcentration[1], false); }",
        "    if (get('saltOutside') === 'high') { addAtoms(2, 0, highConcentration[0], false); addAtoms(0, 0.2, highConcentration[1], false); addAtoms(4, -0.2, highConcentration[1], false); }",
        "  });",
        "}",
        "setupModel();",
        "onPropertyChange('saltInside', function() { reloadModel(); });",
        "onPropertyChange('saltOutside', function() { reloadModel(); });"
      ]
    }
  ],
  "parameters": [
    {
      "name": "saltInside",
      "initialValue": "none"
    },
    {
      "name": "saltOutside",
      "initialValue": "none"
    }
  ],
  "outputs": [
    {
      "name": "waterOutside",
      "value": [
        "const atomsCount = getNumberOfAtoms();",
        "let count = 0;",
        "for (var i = 0; i < atomsCount; i++) {",
        "  let props = getAtomProperties(i);",
        "  if (props.element === 2 && props.x < 2.675) {",
        "    count += 1;",
        "  }",
        "}",
        "return count;"
      ]
    },
    {
      "name": "pressureOutside",
      "value": [
        "return get('waterOutside') * 0.65;"
      ]
    }
  ],
  "filteredOutputs": [
    {
      "name": "pressureOutsideFiltered",
      "property": "pressureOutside",
      "type": "RunningAverage",
      "period": 10000
    }
  ],
  "components": [
    {
      "id": "outside",
      "type": "text",
      "text": "Outside"
    },
    {
      "id": "inside",
      "type": "text",
      "text": "Inside"
    },
    {
      "type": "pulldown",
      "id": "salt-outside",
      "label": "Salt concentration",
      "labelOn": "left",
      "property": "saltOutside",
      "options": [
        {
          "text": "none",
          "value": "none"
        },
        {
          "text": "low",
          "value": "low"
        },
        {
          "text": "high",
          "value": "high"
        }
      ]
    },
    {
      "type": "pulldown",
      "id": "salt-inside",
      "label": "Salt concentration",
      "labelOn": "left",
      "property": "saltInside",
      "options": [
        {
          "text": "none",
          "value": "none"
        },
        {
          "text": "low",
          "value": "low"
        },
        {
          "text": "high",
          "value": "high"
        }
      ]
    },
    {
      "type": "graph",
      "id": "graph",
      "title": "Osmosis in plant cells",
      "xlabel": "Time",
      "ylabel": "",
      "ymin": 0,
      "ymax": 70,
      "xmax": 40,
      "hideAxisValues": true,
      "enableZooming": false,
      "enableAutoScaleButton": false,
      "legendVisible": true,
      "legendLabels": [
        "Number of H2O mol outside",
        "Pressure outside"
      ],
      "properties": [
        "waterOutside",
        "pressureOutsideFiltered"
      ]
    }
  ],
  "layout": {
    "top-left": [
      "outside"
    ],
    "top-right": [
      "inside"
    ],
    "bottom-left": [
      "salt-outside"
    ],
    "bottom-right": [
      "salt-inside"
    ],
    "bottom": [
      "graph"
    ]
  },
  "template": [
    {
      "id": "top-left",
      "bottom": "model.top",
      "left": "model.left"
    },
    {
      "id": "top-right",
      "bottom": "model.top",
      "right": "model.right"
    },
    {
      "id": "bottom-left",
      "top": "model.bottom",
      "left": "model.left",
      "padding-top": "1em"
    },
    {
      "id": "bottom-right",
      "top": "model.bottom",
      "right": "model.right",
      "padding-top": "1em"
    },
    {
      "id": "right",
      "top": "model.top",
      "left": "model.right",
      "padding-right": "1em"
    },
    {
      "id": "bottom",
      "left": "model.left",
      "right": "model.right",
      "top": "bottom-left.bottom",
      "height": "14em",
      "padding-top": "1em"
    }
  ]
}
