{
  "title": "Heat Transfer Micro V2",
  "publicationStatus": "draft",
  "subtitle": "GRASP",
  "about": "",
  "aspectRatio": 1.6,
  "fontScale": 0.75,
  "models": [
    {
      "type": "md2d",
      "id": "vacuum",
      "url": "models/lab-version/1/md2d/grasp/heat-transfer-micro/model-v2.json",
      "viewOptions": {
        "controlButtons": "play_reset",
        "atomRadiusScale": 1.10
      },
      "onLoad": [
        "var DIST_THRESHOLD = 0.156;",
        "var INTERVAL = get('timeStep') * get('timeStepsPerTick') * 3;",
        "var FADE_SPEED = 0.01666;",
        "var POINT_SIZE = 0.018;",
        "var alpha = [];",
        "",
        "function dist(a1, a2) {",
        "  var x = a1.x - a2.x; var y = a1.y - a2.y;",
        "  return Math.sqrt(x * x + y * y);",
        "}",
        "function middle(a1, a2) {",
        "  return {x: a1.x + (a2.x - a1.x) * 0.5 - POINT_SIZE * 0.5, y: a1.y + (a2.y - a1.y) * 0.5 - POINT_SIZE * 0.5};",
        "}",
        "function color(alpha) {",
        "  return 'rgba(255, 16, 16, ' + alpha + ')';",
        "}",
        "function addPoint(coords) {",
        "  addShape({",
        "    type: 'ellipse',",
        "    x: coords.x,",
        "    y: coords.y,",
        "    width: POINT_SIZE,",
        "    height: POINT_SIZE,",
        "    color: color(1),",
        "    lineColor: 'transparent',",
        "    layer: 1",
        "  });",
        "}",
        "function addPoints() {",
        "  for (var i = 0, len = getNumberOfAtoms(); i < len; i++) {",
        "    for (var j = i + 1; j < len; j++) {",
        "      var a1 = getAtomProperties(i);",
        "      var a2 = getAtomProperties(j);",
        "      if (dist(a1, a2) < DIST_THRESHOLD) {",
        "        addPoint(middle(a1, a2));",
        "        alpha.push(1);",
        "      }",
        "    }",
        "  }",
        "}",
        "function updateAlpha() {",
        "  for (var i = 0, len = getNumberOfShapes(); i < len; i++) {",
        "    alpha[i] -= FADE_SPEED * INTERVAL;",
        "    if (alpha[i] > 0) {",
        "      setShapeProperties(i, {color: color(alpha[i])});",
        "    }",
        "  }",
        "}",
        "function rmInvisiblePoints() {",
        "  while (alpha[0] <= 0) {",
        "    alpha.shift();",
        "    removeShape(0);",
        "  }",
        "}",
        "",
        "callEvery(INTERVAL, function () {",
        "  batch(function () {",
        "    addPoints();",
        "    updateAlpha();",
        "    rmInvisiblePoints();",
        "  });",
        "});"
      ]
    }
  ],
  "components": [
    {
      "type": "checkbox",
      "id": "ke-shading",
      "text": "KE Shading",
      "property": "keShading"
    },
    {
      "type": "button",
      "id": "add-ke",
      "text": "+",
      "action": [
        "addKEToAtoms(0.1, [0]);"
      ]
    },
    {
      "type": "button",
      "id": "rm-ke",
      "text": "-",
      "action": [
        "setAtomProperties(0, {vx: 0, vy: 0});",
        "addKEToAtoms(-0.05);"
      ]
    }
  ]
}
